{% load static i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
<head>
  <meta charset="UTF-8">
  <title>{% trans "Teacher test" %}</title>

  <style>
    *{ box-sizing:border-box; margin:0; padding:0; font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif; }
    body{ background:#00a9ff; display:flex; justify-content:center; align-items:center; min-height:100vh; }

    .phone{
      width:100%; max-width:420px; height:100vh; margin:0 auto;
      background:linear-gradient(180deg,#020617,#0b1220);
      display:flex; flex-direction:column;
      border-radius:12px; overflow:hidden;
      box-shadow:0 18px 40px rgba(15,23,42,.75);
    }
    .phone__top,.phone__bottom{ height:40px; background:#020617; }

    .screen{
      flex:1; background:#e5edf9; padding:18px 16px;
      width:100%; max-width:428px; margin:0 auto;
      display:flex; flex-direction:column; align-items:center;
      overflow-y:auto;
    }

    .wrap{
      width:100%;
      max-width:392px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    /* header card */
    .header-card{
      width:100%;
      background:#ffffff;
      border:1px solid rgba(148,163,184,.35);
      box-shadow:0 12px 24px rgba(148,163,184,.45);
      border-radius:20px;
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .topic-title{
      font-size:22px;
      font-weight:900;
      text-align:center;
      color:#0b1220;
      line-height:1.15;
      word-break:break-word;
    }

    .meta-row{
      display:flex;
      gap:10px;
      justify-content:space-between;
      align-items:center;
      flex-wrap:wrap;
    }

    .chip{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:6px 10px;
      border-radius:999px;
      background:#eef4ff;
      border:1px solid rgba(37,99,235,.20);
      color:#1e3a8a;
      font-weight:900;
      font-size:12px;
    }

    .timer-pill{
      flex:0 0 auto;
      min-width:118px;
      height:42px;
      border-radius:999px;
      background:#0b1220;
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:900;
      letter-spacing:.5px;
      border:4px solid #ef4444;
      box-shadow:0 10px 18px rgba(15,23,42,.18);
    }
    #timer{ font-size:16px; }

    .test-header-img{
      width:210px;
      max-width:85%;
      margin:4px auto 2px;
      display:block;
      filter: drop-shadow(0 10px 14px rgba(15,23,42,.18));
    }

    .level-title{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:8px 14px;
      border-radius:999px;
      font-weight:900;
      font-size:12px;
      background:#dbeafe;
      border:1px solid rgba(30,58,138,.15);
      color:#1e3a8a;
      align-self:center;
    }

    /* question */
    .question-card{
      width:100%;
      background:#ffffff;
      border:1px solid rgba(148,163,184,.35);
      box-shadow:0 12px 24px rgba(148,163,184,.40);
      border-radius:20px;
      padding:14px;
    }
    .question-box{
      width:100%;
      background:#e5edf9;
      border-radius:16px;
      padding:16px 14px;
      color:#0f172a;
      font-weight:900;
      font-size:16px;
      line-height:1.25;
      text-align:center;
      word-break:break-word;
    }

    /* answers */
    .answers-grid{
      width:100%;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      margin-top:12px;
    }

    .answer-btn{
      width:100%;
      border:none;
      cursor:pointer;
      border-radius:18px;
      padding:14px 12px;
      min-height:82px;

      background:#ffffff;
      border:1px solid rgba(148,163,184,.35);
      box-shadow:0 12px 24px rgba(148,163,184,.45);

      text-align:left;
      display:flex;
      align-items:flex-start;
      gap:10px;

      transition:transform .12s ease, box-shadow .12s ease;
    }
    .answer-btn:hover{
      transform: translateY(-1px);
      box-shadow:0 18px 30px rgba(148,163,184,.65);
    }
    .answer-btn:active{ transform: translateY(1px); }

    .ans-dot{
      flex:0 0 auto;
      width:30px;
      height:30px;
      border-radius:12px;
      background:#dcfce7;
      border:1px solid rgba(22,163,74,.18);
      color:#14532d;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:900;
    }
    .ans-text{
      color:#0f172a;
      font-weight:800;
      font-size:13px;
      line-height:1.25;
      word-break:break-word;
      min-width:0;
    }

    @media (max-width: 380px){
      .answers-grid{ grid-template-columns:1fr; }
      .timer-pill{ min-width:110px; }
    }
  </style>
</head>

<body>
<div class="phone">
  <div class="phone__top"></div>

  <div class="screen">
    <div class="wrap">

      <div class="header-card">
        <div class="topic-title">{{ topic_title }}</div>

        <div class="meta-row">
          <span class="chip">{% trans "Difficulty" %}: {{ difficulty_name }}</span>
          <span class="chip">{% trans "Question" %} {{ q_index }}/{{ q_total }}</span>

          <span id="timer"
                class="timer-pill"
                data-remaining="{% if remaining_sec is None %}-1{% else %}{{ remaining_sec }}{% endif %}"
                data-finish-url="{{ finish_url }}">
            00:00
          </span>
        </div>
      </div>

      <img src="{% static 'img/python.png' %}" alt="Python" class="test-header-img">

      <div class="level-title">{{ difficulty_name }}</div>

      <div class="question-card">
        <div class="question-box">{{ question.question_text }}</div>
      </div>

      <form method="post">
        {% csrf_token %}
        <div class="answers-grid">
          {% for ans in answers %}
            <button type="submit" name="answer_id" value="{{ ans.id }}" class="answer-btn">
              <span class="ans-dot">{{ forloop.counter }}</span>
              <span class="ans-text">{{ ans.answer_text }}</span>
            </button>
          {% endfor %}
        </div>
      </form>

    </div>
  </div>

  <div class="phone__bottom"></div>
</div>

<script>
(function () {
  const el = document.getElementById('timer');
  if (!el) return;

  let remaining = parseInt(el.dataset.remaining || "0", 10);
  const finishUrl = el.dataset.finishUrl || "";

  function pad(n){ return String(n).padStart(2, '0'); }
  function render(){
    const m = Math.floor(remaining / 60);
    const s = remaining % 60;
    el.textContent = pad(m) + ":" + pad(s);
  }

  // no limit
  if (!Number.isFinite(remaining) || remaining < 0){
    el.textContent = "âˆž";
    return;
  }

  render();

  const t = setInterval(() => {
    remaining -= 1;
    if (remaining <= 0){
      clearInterval(t);
      el.textContent = "00:00";
      if (finishUrl) window.location.href = finishUrl;
      return;
    }
    render();
  }, 1000);
})();
</script>
</body>
</html>
